package uk.gov.justice.digital.sonar.plugin.containercheck.model;

import static org.assertj.core.api.Assertions.assertThat;

import java.util.Collections;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

class VulnerabilityTest {

    @DisplayName("Tests the formatted string used in Sonar display with no fixed version")
    @Test
    void testToSonarMessageNoFixedVersion() {

        final Vulnerability vulnerability = new Vulnerability("CVE-2011", "bash", "1.0", null, "CVE-2011-TITLE",
            "Description", "MEDIUM", Collections.emptyList());

        assertThat(vulnerability.toSonarMessage())
            .isEqualTo("Package: bash | ID: CVE-2011 | Installed version: 1.0 | Fixed in version: N/A | Description: Description");
    }

    @DisplayName("Tests the formatted string used in Sonar display with a fixed version")
    @Test
    void testToSonarMessageWithFixedVersion() {

        final Vulnerability vulnerability = new Vulnerability("CVE-2011", "bash", "1.7", "2.1.1  ", "CVE-2011-TITLE",
            "Description", "MEDIUM", Collections.emptyList());

        assertThat(vulnerability.toSonarMessage())
            .isEqualTo("Package: bash | ID: CVE-2011 | Installed version: 1.7 | Fixed in version: 2.1.1 | Description: Description");
    }
}
